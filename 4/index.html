<!DOCTYPE html>
<html>
<body>

<h2>Tutorial 4. RSA Encryption and Decryption</h2>

<p>Rules</p>
<ul>
  <li>gcd(e, phi(n)) = 1</li>
  <li>(e * d) % phi(n) = 1</li>
  <li>Message m must be smaller than n!</li>
</ul>

<!-- Encryption -->
<hr>
<h4>RSA Encryption:</h4>
Use public key e <br>
n: <input id="n" value="35"/><br/>
e: <input id="e" value="5"/><br/>
Plaintext m: <input id="m" value="5"/><br/>
<button type="button" onclick="RSA_encrypt()">Encrypt!</button>
<br/><br/>
Ciphertext c = m^e mod n:
<div id="encrypted_value"></div>

<!-- Decryption -->
<br/><hr>
<h4>RSA Decryption</h4>
Use private key d <br>
d: <input id="d" value="5"/><br/>
<button type="button" onclick="RSA_decrypt()">Decrypt!</button>
<br/><br/>
Plaintext m = c^e mod n:
<div id="decrypted_value"></div>


<script>
// RSA encryption
function RSA_encrypt(){
    // get RSA public key
    var n = document.getElementById("n").value;
    var e = document.getElementById("e").value;
    // get plaintext as m
    var m = document.getElementById("m").value;

    // RSA encryption as
    // m^e mod n
    ciphertext = Math.pow(m, e) % n;
    document.getElementById('encrypted_value').innerHTML = ciphertext;
}

// RSA decryption
function RSA_decrypt(){
    // get RSA private key
    var n = document.getElementById("n").value;
    var d = document.getElementById("d").value;
    // get ciphertext as c
    var c = document.getElementById("encrypted_value").innerHTML;

    // RSA decryption as
    // c^d mod n
    plaintext = Math.pow(c, d) % n;
    document.getElementById('decrypted_value').innerHTML = plaintext;
}


</script>

</body>
</html>
